//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: jar:file:/Users/tway/dev/FeedRead/core/libs/shelf.jar!com/toddway/shelf/ShelfItem.java
//


#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "ShelfItem.h"
#include "Storage.h"
#include "java/lang/Exception.h"
#include "java/util/Date.h"
#include "java/util/concurrent/TimeUnit.h"

@interface ComToddwayShelfShelfItem () {
 @public
  NSString *key_;
  id<ComToddwayShelfStorage> storage_;
  id item_;
}

@end

J2OBJC_FIELD_SETTER(ComToddwayShelfShelfItem, key_, NSString *)
J2OBJC_FIELD_SETTER(ComToddwayShelfShelfItem, storage_, id<ComToddwayShelfStorage>)
J2OBJC_FIELD_SETTER(ComToddwayShelfShelfItem, item_, id)

@implementation ComToddwayShelfShelfItem

- (instancetype)initWithComToddwayShelfStorage:(id<ComToddwayShelfStorage>)storage
                                  withNSString:(NSString *)key {
  ComToddwayShelfShelfItem_initWithComToddwayShelfStorage_withNSString_(self, storage, key);
  return self;
}

- (jboolean)exists {
  return [((id<ComToddwayShelfStorage>) nil_chk(storage_)) containsWithNSString:key_];
}

- (jboolean)putWithId:(id)item {
  self->item_ = item;
  jboolean result = NO;
  @try {
    [((id<ComToddwayShelfStorage>) nil_chk(storage_)) putWithNSString:key_ withId:item];
    result = YES;
  }
  @catch (JavaLangException *e) {
    [((JavaLangException *) nil_chk(e)) printStackTrace];
  }
  return result;
}

- (id)getWithIOSClass:(IOSClass *)clazz {
  if (item_ == nil) {
    @try {
      return [((id<ComToddwayShelfStorage>) nil_chk(storage_)) getWithNSString:key_ withIOSClass:clazz];
    }
    @catch (JavaLangException *e) {
      [((JavaLangException *) nil_chk(e)) printStackTrace];
    }
  }
  return (id) item_;
}

- (jboolean)isOlderThanWithLong:(jlong)value
withJavaUtilConcurrentTimeUnitEnum:(JavaUtilConcurrentTimeUnitEnum *)unit {
  return [self isOlderThanWithLong:[((JavaUtilConcurrentTimeUnitEnum *) nil_chk(unit)) toMillisWithLong:value]];
}

- (jboolean)isOlderThanWithLong:(jlong)millis {
  jboolean isOlderThan = YES;
  if ([self exists]) {
    jlong thenMillis = [((id<ComToddwayShelfStorage>) nil_chk(storage_)) lastModifiedWithNSString:key_];
    jlong nowMillis = [new_JavaUtilDate_init() getTime];
    isOlderThan = (thenMillis < (nowMillis - millis));
  }
  return isOlderThan;
}

- (jboolean)clear {
  jboolean result = NO;
  @try {
    item_ = nil;
    result = [((id<ComToddwayShelfStorage>) nil_chk(storage_)) delete__WithNSString:key_];
  }
  @catch (JavaLangException *e) {
    [((JavaLangException *) nil_chk(e)) printStackTrace];
  }
  return result;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithComToddwayShelfStorage:withNSString:", "ShelfItem", NULL, 0x1, NULL, NULL },
    { "exists", NULL, "Z", 0x1, NULL, NULL },
    { "putWithId:", "put", "Z", 0x1, NULL, "(TT;)Z" },
    { "getWithIOSClass:", "get", "TT;", 0x1, NULL, "<T:Ljava/lang/Object;>(Ljava/lang/Class<TT;>;)TT;" },
    { "isOlderThanWithLong:withJavaUtilConcurrentTimeUnitEnum:", "isOlderThan", "Z", 0x1, NULL, NULL },
    { "isOlderThanWithLong:", "isOlderThan", "Z", 0x1, NULL, NULL },
    { "clear", NULL, "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "key_", NULL, 0x2, "Ljava.lang.String;", NULL, NULL,  },
    { "storage_", NULL, 0x2, "Lcom.toddway.shelf.Storage;", NULL, NULL,  },
    { "item_", NULL, 0x2, "TT;", NULL, "TT;",  },
  };
  static const J2ObjcClassInfo _ComToddwayShelfShelfItem = { 2, "ShelfItem", "com.toddway.shelf", NULL, 0x1, 7, methods, 3, fields, 0, NULL, 0, NULL, NULL, "<T:Ljava/lang/Object;>Ljava/lang/Object;" };
  return &_ComToddwayShelfShelfItem;
}

@end

void ComToddwayShelfShelfItem_initWithComToddwayShelfStorage_withNSString_(ComToddwayShelfShelfItem *self, id<ComToddwayShelfStorage> storage, NSString *key) {
  (void) NSObject_init(self);
  self->key_ = key;
  self->storage_ = storage;
}

ComToddwayShelfShelfItem *new_ComToddwayShelfShelfItem_initWithComToddwayShelfStorage_withNSString_(id<ComToddwayShelfStorage> storage, NSString *key) {
  ComToddwayShelfShelfItem *self = [ComToddwayShelfShelfItem alloc];
  ComToddwayShelfShelfItem_initWithComToddwayShelfStorage_withNSString_(self, storage, key);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComToddwayShelfShelfItem)
